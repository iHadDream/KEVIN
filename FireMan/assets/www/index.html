<!DOCTYPE HTML >

<html>


      <head>
		<meta charset="utf-8">
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>PhoneGap</title>
		
        <script type="text/javascript" charset="utf-8" src="phonegap.js"></script>
        <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=q9MIDngCI7Sa6LPcAfAmq46oMtXSaLXx"></script>
		<script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
		<script type="text/javascript" src="http://api.map.baidu.com/api?key=&v=1.1&services=true"></script>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css">
		<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
		<style>
		  html,body{margin:0;padding:0;width: 100%;height: 100%;font-family:"微软雅黑";}
		  #allmap{height:490px;width:100%;}
		  #r-result,#r-result table{width:100%;}}
	      .iw_poi_title {color:#CC5522;font-size:14px;font-weight:bold;overflow:hidden;padding-right:13px;white-space:nowrap}
	      .iw_poi_content {font:12px arial,sans-serif;overflow:visible;padding-top:4px;white-space:-moz-pre-wrap;word-wrap:break-word}
			.header{
				width:100%;
				height:45px;
				
				text-align:center;
				
				font-family:"微软雅黑";
				font-size:24px;
				color:#fff;
				letter-spacing:8px;
			}
			 
			.content{
				width:100%;
				height:664px;
				background-color:#fff;
			}
			.find{
				 
				 
			}
			.footer{
				float:left;
				height:80px;
				width:100%;
				 
				
			}
			.footer a{
				
			}
			 
		</style>
		
        
      </head>


      <body>
		//首页，地图查询
      	<div class="container" data-role="page" id="pageone">
	  		<div class="header" data-role="header" data-theme="b" >
	  			 
	  			 <a href="#"  data-inline="true"  data-icon="home">首页</a>
    				火灾宝
   				 <a href="#" data-inline="true"  data-icon="search">搜索</a>
	  			 
	  		</div>
                                  		
      		<div class="content" data-theme="c" >
      			<div>
      				<input type="text" placeholder="请输入火灾地点.." data-inline="true"></input>    				
      			</div>
                                  		
  				<!--百度地图容器-->
 
			  <div id="allmap"></div>
				<div id="driving_way">
					<select data-corners="false">
						<option value="0">最少时间</option>
						<option value="1">最短距离</option>
						<option value="2">避开高峰</option>
					</select>
				<a type="button" id="result" value="查询" data-role="button" 
				  data-theme="b">查询</a>
			</div>
			<div id="r-result"></div>
      		</div>
                                  		
                                  
                                  	
									                                  	
  		
  		<div class="footer" data-role="footer" data-theme="c">
  			
  			<div data-role="navbar" >
		      <ul>
		         <li> <a href="#pageone"  class="ui-btn-active ui-state-persist" data-icon="grid" data-transition="none">地图</a></li>
		        <li><a href="#pagetwo"  data-icon="star" data-transition="none">起火点详情</a></li>
		        <li><a href="#pagethree"   data-icon="alert" data-transition="none">周边</a></li>
		                                  			
		                                  			
		      </ul>
		    </div>
                                  			
      		</div>
      	</div>
      	
      	  //起火点 户型图等   
      	<div class="container" data-role="page" id="pagetwo">
	  		<div class="header" data-role="header" data-theme="b">
	  			 <a href="#"  data-inline="true"  data-icon="home">首页</a>
    				火灾宝
   				 <a href="#" data-inline="true"  data-icon="search">搜索</a>
	  		</div>
                                  		
      		<div class="content" data-theme="c" >
      			 
			 
      		</div>
                                  		
                                  
                            	
									                                  	
  		
  		<div class="footer" data-role="footer" data-theme="c">
  			
  			<div data-role="navbar" >
		      <ul>
		        <li> <a href="#pageone"  data-icon="grid" data-transition="none">地图</a></li>
		        <li><a href="#pagetwo"  class="ui-btn-active ui-state-persist" data-icon="star" data-transition="none">起火点详情</a></li>
		        <li><a href="#pagethree"   data-icon="alert" data-transition="none">周边</a></li>
		        
		                                  			
		                                  			
		      </ul>
		    </div>
                                  			
      		</div>
      	</div>
      	
      //周边危险地点 POI
      	<div class="container" data-role="page" id="pagethree">
	  		<div class="header" data-role="header" data-theme="b">
	  			 <a href="#"  data-inline="true"  data-icon="home">首页</a>
    				火灾宝
   				 <a href="#" data-inline="true"  data-icon="search">搜索</a>
	  		</div>
                                  		
      		<div class="content" data-theme="c" >
      		 
      		</div>
                                  		
                                  
                                  	
									                                  	
  		
  		<div class="footer" data-role="footer" data-theme="c">
  			
  			<div data-role="navbar" >
		      <ul>
		        <li> <a href="#pageone"  data-icon="grid" data-transition="none">地图</a></li>
		        <li><a href="#pagetwo"  data-icon="star" data-transition="none">起火点详情</a></li>
		        <li><a href="#pagethree"  class="ui-btn-active ui-state-persist"  data-icon="alert" data-transition="none">周边</a></li>
		        
		                                  			
		                                  			
		      </ul>
		    </div>
                                  			
      		</div>
      	</div>
                                  	
		
		<script type="text/javascript">
    //创建和初始化地图函数：
    function initMap(){
        createMap();//创建地图
        setMapEvent();//设置地图事件
        addMapControl();//向地图添加控件
        addMarker();//向地图中添加marker
    }
    
    //创建地图函数：
    function createMap(){
        var map = new BMap.Map("allmap");//在百度地图容器中创建一个地图
        var point = new BMap.Point(125.436617,43.831329);//定义一个中心点坐标
        map.centerAndZoom(point,17);//设定地图的中心点和坐标并将地图显示在地图容器中
        window.map = map;//将map变量存储在全局
    }
    
    //地图事件设置函数：
    function setMapEvent(){
        map.enableDragging();//启用地图拖拽事件，默认启用(可不写)
        map.enableScrollWheelZoom();//启用地图滚轮放大缩小
        map.enableDoubleClickZoom();//启用鼠标双击放大，默认启用(可不写)
        map.enableKeyboard();//启用键盘上下左右键移动地图
    }
    
    //地图控件添加函数：
    function addMapControl(){
        //向地图中添加缩放控件
	var ctrl_nav = new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE});
	map.addControl(ctrl_nav);
        //向地图中添加缩略图控件
	var ctrl_ove = new BMap.OverviewMapControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,isOpen:1});
	map.addControl(ctrl_ove);
        //向地图中添加比例尺控件
	var ctrl_sca = new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});
	map.addControl(ctrl_sca);
    }
    
    //标注点数组
    var markerArr = [{title:"当前位置",content:"我的备注",point:"125.433446|43.832044",isOpen:0,icon:{w:21,h:21,l:0,t:0,x:6,lb:5}}
		 ];
    //创建marker
    function addMarker(){
        for(var i=0;i<markerArr.length;i++){
            var json = markerArr[i];
            var p0 = json.point.split("|")[0];
            var p1 = json.point.split("|")[1];
            var point = new BMap.Point(p0,p1);
			var iconImg = createIcon(json.icon);
            var marker = new BMap.Marker(point,{icon:iconImg});
			var iw = createInfoWindow(i);
			var label = new BMap.Label(json.title,{"offset":new BMap.Size(json.icon.lb-json.icon.x+10,-20)});
			marker.setLabel(label);
            map.addOverlay(marker);
            label.setStyle({
                        borderColor:"#808080",
                        color:"#333",
                        cursor:"pointer"
            });
			
			(function(){
				var index = i;
				var _iw = createInfoWindow(i);
				var _marker = marker;
				_marker.addEventListener("click",function(){
				    this.openInfoWindow(_iw);
			    });
			    _iw.addEventListener("open",function(){
				    _marker.getLabel().hide();
			    })
			    _iw.addEventListener("close",function(){
				    _marker.getLabel().show();
			    })
				label.addEventListener("click",function(){
				    _marker.openInfoWindow(_iw);
			    })
				if(!!json.isOpen){
					label.hide();
					_marker.openInfoWindow(_iw);
				}
			})()
        }
    }
    //创建InfoWindow
    function createInfoWindow(i){
        var json = markerArr[i];
        var iw = new BMap.InfoWindow("<b class='iw_poi_title' title='" + json.title + "'>" + json.title + "</b><div class='iw_poi_content'>"+json.content+"</div>");
        return iw;
    }
    //创建一个Icon
    function createIcon(json){
        var icon = new BMap.Icon("http://app.baidu.com/map/images/us_mk_icon.png", new BMap.Size(json.w,json.h),{imageOffset: new BMap.Size(-json.l,-json.t),infoWindowOffset:new BMap.Size(json.lb+5,1),offset:new BMap.Size(json.x,json.h)})
        return icon;
    }
    
    initMap();//创建和初始化地图
    
    
    // 百度地图API功能
	
	var start = "北京消防教育训练中心";
	var end ="天安门";
	map.centerAndZoom(new BMap.Point(116.404, 39.915), 11);
	//三种驾车策略：最少时间，最短距离，避开高速
	var routePolicy = [BMAP_DRIVING_POLICY_LEAST_TIME,BMAP_DRIVING_POLICY_LEAST_DISTANCE,BMAP_DRIVING_POLICY_AVOID_HIGHWAYS];
	$("#result").click(function(){
		map.clearOverlays(); 
		var i=$("#driving_way select").val();
		search(start,end,routePolicy[i]); 
		function search(start,end,route){ 
			var driving = new BMap.DrivingRoute(map, {renderOptions:{map: map, autoViewport: true},policy: route});
			driving.search(start,end);
		}
	});
	

</script>

                                  </body>



                                </html>
                                
 


 

 